# Sprint 3 - Nivel 1


## Exercici 1


### Diseño de tabla


En primer lugar, debo crear la tabla _**user**_ con los respectivos datos entregados: 

| Field          | Type          | Key  | 
|----------------|---------------|------|
| id             |  varchar(15)  |  PK  |  
| iban           |  varchar(15)  |      |
| pan            |  varchar(15)  |      |
| pin            |  varchar(15)  |      |
| cvv            |  varchar(15)  |      |
| expiring_date  |  date         |      |

Al momento de crear la tabla es posible elegir el type. La diferencia entre varchar y char, radica en que si el valor del campo es variable la forma de almacenamiento tambien lo es y por ello permite optimizar/ahorrar espacio.

El codigo de creación de la tabla es el siguiente: 
```sql
create table credit_card (
    id   	varchar(10) PRIMARY KEY,
    iban 	varchar(30),
    pan 	varchar(15),
    pin 	varchar(10),
    cvv 	varchar(5),
    expiring_date date
);
```
La nueva tabla debe ser capaz de identificar de forma única cada tarjeta y establecer una relación adecuada con las otras dos tablas ("transaction" y "company"). 

![logo](relaciones.png)


- Después de crear la tabla será necesario que ingreses la información del documento denominado "dades_introducir_credit". 

Al momento de introducir los datos se generan
Codigo completo:
```sql
create table credit_card (
    id   	varchar(10) PRIMARY KEY,
    iban 	varchar(35),
    pan 	varchar(20),
    pin 	varchar(4),
    cvv 	varchar(3),
    expiring_date varchar(8)
);
```
### Observaciones: 
1. En _**trasactions**_ tengo el dato de credit_card_id, a traves de esto puedo generar una tabla que me permita tener un id unico para relacionar los datos 
2. La relación entre las tablas  user, credit_card, company es de 1:n respecto a transaction.



## Exercici 2
El departament de Recursos Humans ha identificat un error en el número de compte de l'usuari amb el:
- IBAN CcU-2938. 
- Es requereix actualitzar la informació que identifica un compte bancari a nivell internacional (identificat com 
-"IBAN"): TR323456312213576817699999. 
### Paso 1
Voy a identificar el dato mediante el comando:
```sql
SELECT id, iban  FROM credit_card WHERE id = "CcU-2938";
```
El output es:

|  id      | iban                       |
|----------|----------------------------|
| CcU-2938 | TR301950312213576817638661 |


### Paso 2
Ahora reemplazo a traves del siguiente comando: 

```sql
update credit_card 
set iban = 'TR323456312213576817699999' 
where id = "CcU-2938";
```
Realizo la comprobación mediante el mismo codigo del paso 1

```sql
SELECT id, iban  FROM credit_card WHERE id = "CcU-2938";
```
El output es el siguiente: 
|  id      | iban                        |
|----------|-----------------------------|
| CcU-2938 | TR323456312213576817699999  |


![logo](ex2.png)



## Exercici 3

En la taula "transaction" ingressa un nou usuari amb la següent informació:

### Paso 1: 
Verificar los campos de la tabla transaccion para generar el comando de insertar:

```sql
SHOW COLUMNS FROM transaction;
```

| Field           | Type            | Null | Key | Default | Extra |
|-----------------|-----------------|------|-----|---------|-------|
| id              | varchar(255)    | NO   | PRI | NULL    |       |
| credit_card_id  | varchar(15)     | YES  |     | NULL    |       |
| company_id      | varchar(20)     | YES  | MUL | NULL    |       |
| user_id         | int             | YES  | MUL | NULL    |       |
| lat             | float           | YES  |     | NULL    |       |
| longitude       | float           | YES  |     | NULL    |       |
| timestamp       | timestamp       | YES  |     | NULL    |       |
| amount          | decimal(10,2)   | YES  |     | NULL    |       |
| declined        | tinyint(1)      | YES  |     | NULL    |       |

### Paso 2:  

Para ingresar lo que pide el enunciado debo utilizar este codigo:
```sql
INSERT INTO transaction(id, credit_card_id, company_id, user_id, lat, longitude, timestamp, amount, declined)
VALUES ("108B1D1D-5B23-A76C-55EF-C568E49A99DD", "CcU-9999", "b-9999", 9999, 829.999, -117.999, NOW(), 111.11, 0);
```
Sin embargo, antes de utlizarlo debo insertar el valor de b-9999 en la tabla de company, ya que esta esta relacionada con transaction
```sql
INSERT INTO company(id) VALUES ('b-9999');
```

### Ahora ingreso el valor en la tabla

```sql
INSERT INTO transaction(id, credit_card_id, company_id, user_id, lat, longitude, timestamp, amount, declined)
VALUES ("108B1D1D-5B23-A76C-55EF-C568E49A99DD", "CcU-9999", "b-9999", 9999, 829.999, -117.999, NOW(), 111.11, 0);
```
### Reviso que efectivamente se ha hecho bien:
```sql
select * from transaction
where id ="108B1D1D-5B23-A76C-55EF-C568E49A99DD"
```


## Exercici 4

Des de recursos humans et sol·liciten eliminar la columna "pan" de la taula credit_*card. Recorda mostrar el canvi realitzat.

